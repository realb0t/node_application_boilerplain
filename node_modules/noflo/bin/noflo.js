// Generated by CoffeeScript 1.3.1
(function() {
  var cli, noflo, nofloRoot, path;

  nofloRoot = "" + __dirname + "/..";

  noflo = require("noflo");

  cli = require("cli");

  path = require("path");

  cli.enable("help");

  cli.enable("version");

  cli.enable("glob");

  cli.enable("daemon");

  cli.setApp("" + nofloRoot + "/package.json");

  cli.parse({
    listen: ['l', 'Start NoFlo server on this port', 'number'],
    interactive: ['i', 'Start an interactive NoFlo shell'],
    debug: ['debug', 'Start NoFlo in debug mode']
  });

  cli.main(function(args, options) {
    var arg, shell, _i, _len, _ref, _results;
    if (options.interactive) {
      process.argv = [process.argv[0], process.argv[1]];
      shell = require("" + nofloRoot + "/lib/shell");
    }
    if (!cli.args.length) {
      return;
    }
    _ref = cli.args;
    _results = [];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      arg = _ref[_i];
      if (arg.indexOf(".json") === -1 && arg.indexOf(".fbp") === -1) {
        console.error("" + arg + " is not a NoFlo graph file, skipping");
        continue;
      }
      arg = path.resolve(process.cwd(), arg);
      _results.push(noflo.loadFile(arg, function(network) {
        if (!options.interactive) {
          return;
        }
        shell.app.network = network;
        return shell.app.setPrompt(network.graph.name);
      }, options.debug));
    }
    return _results;
  });

}).call(this);
